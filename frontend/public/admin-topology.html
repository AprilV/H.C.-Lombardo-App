<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Topology - 3D Visualization</title>
    
    <!-- Three.js for 3D Graphics -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/renderers/CSS2DRenderer.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            overflow: hidden;
        }
        
        #topology-canvas {
            width: 100%;
            height: 100vh;
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-width: 350px;
            z-index: 100;
        }
        
        .info-panel h2 {
            color: #3b82f6;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .info-panel p {
            color: #cbd5e1;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 15px;
            z-index: 100;
        }
        
        .controls button {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .controls button:hover {
            transform: scale(1.05);
        }
        
        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 15px;
            max-width: 250px;
            z-index: 100;
        }
        
        .legend h3 {
            color: #10b981;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }
        
        .legend-text {
            color: #cbd5e1;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div id="topology-canvas"></div>
    
    <div class="info-panel">
        <h2>üèóÔ∏è System Architecture</h2>
        <p><strong>H.C. Lombardo App</strong></p>
        <p>Full-stack NFL analytics platform with machine learning predictions and real-time data updates.</p>
        <p><strong>Drag</strong> to rotate | <strong>Scroll</strong> to zoom | <strong>Click</strong> components for details</p>
    </div>
    
    <div class="legend">
        <h3>üì± App Architecture</h3>
        <div class="legend-item">
            <div class="legend-color" style="background: #4a90e2;"></div>
            <div class="legend-text">User Interface</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #10b981;"></div>
            <div class="legend-text">Classifier (Win/Loss)</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ec4899;"></div>
            <div class="legend-text">Regressor (Score)</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #5a6c7d;"></div>
            <div class="legend-text">Application Server</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #2a9d8f;"></div>
            <div class="legend-text">Data Storage</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #f59e0b;"></div>
            <div class="legend-text">Data Schema</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #8b5cf6;"></div>
            <div class="legend-text">External Data</div>
        </div>
            <div class="legend-text">nflverse Data</div>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ef4444;"></div>
            <div class="legend-text">ML Models</div>
        </div>
    </div>
    
    <div class="controls">
        <button onclick="resetCamera()">üîÑ Reset View</button>
        <button onclick="toggleAutoRotate()">üîÅ Auto Rotate</button>
    </div>
    
    <script>
        // 3D Topology Visualization
        let scene, camera, renderer, controls;
        let animationId;
        let autoRotate = true;
        
        function init() {
            const container = document.getElementById('topology-canvas');
            
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0e27);
            scene.fog = new THREE.Fog(0x0a0e27, 50, 150);
            
            // Camera
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 20, 60);
            camera.lookAt(0, 0, 0);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);
            
            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 30;
            controls.maxDistance = 120;
            controls.autoRotate = autoRotate;
            controls.autoRotateSpeed = 1.0;
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(20, 30, 20);
            scene.add(directionalLight);
            
            const backLight = new THREE.DirectionalLight(0x6366f1, 0.3);
            backLight.position.set(-20, -20, -20);
            scene.add(backLight);
            
            // Grid
            const grid = new THREE.GridHelper(100, 20, 0x1e293b, 0x0f172a);
            grid.position.y = -5;
            scene.add(grid);
            
            // Create system components
            createSystemTopology();
            
            // Start animation
            animate();
            
            // Handle resize
            window.addEventListener('resize', onWindowResize);
        }
        
        function createSystemTopology() {
            // Helper function to add labels
            function addLabel(text, object, className) {
                const div = document.createElement('div');
                div.className = 'label ' + className;
                div.innerHTML = text;
                div.style.color = '#fff';
                div.style.fontSize = '14px';
                div.style.fontWeight = 'bold';
                div.style.textShadow = '2px 2px 4px rgba(0,0,0,0.8)';
                div.style.pointerEvents = 'none';
                div.style.textAlign = 'center';
                
                const label = new THREE.CSS2DObject(div);
                label.position.set(0, 7, 0);
                object.add(label);
            }

            // ========================================
            // LAYER 1: USER INTERFACE (Mobile App)
            // ========================================
            
            // Mobile Device - Rectangle with rounded screen
            const mobileGroup = new THREE.Group();
            
            // Phone body
            const phoneBody = new THREE.Mesh(
                new THREE.BoxGeometry(4, 7, 0.5),
                new THREE.MeshPhongMaterial({ 
                    color: 0x1e293b,
                    emissive: 0x1e293b, 
                    emissiveIntensity: 0.3,
                    shininess: 100
                })
            );
            mobileGroup.add(phoneBody);
            
            // Screen (glowing)
            const screen = new THREE.Mesh(
                new THREE.BoxGeometry(3.6, 6.4, 0.3),
                new THREE.MeshPhongMaterial({ 
                    color: 0x4a90e2,
                    emissive: 0x4a90e2, 
                    emissiveIntensity: 0.8,
                    shininess: 120
                })
            );
            screen.position.z = 0.4;
            mobileGroup.add(screen);
            
            mobileGroup.userData.pulsePhase = 0;
            mobileGroup.userData.material = screen.material;
            
            mobileGroup.position.set(-40, 8, 0);
            scene.add(mobileGroup);
            
            addLabel('User Interface<br><small>React Web App</small>', mobileGroup, 'label-ui');

            // ========================================
            // LAYER 2: PREDICTION ENGINE (2 ML Models)
            // ========================================
            
            // Classifier Model (Left) - Win/Loss Prediction
            const classifierGroup = new THREE.Group();
            
            const classifierCore = new THREE.Mesh(
                new THREE.SphereGeometry(2.5, 32, 32),
                new THREE.MeshPhongMaterial({ 
                    color: 0x10b981,
                    emissive: 0x10b981, 
                    emissiveIntensity: 0.7,
                    shininess: 120
                })
            );
            classifierGroup.add(classifierCore);
            
            // Neural rings
            for (let i = 0; i < 3; i++) {
                const ring = new THREE.Mesh(
                    new THREE.TorusGeometry(1.5 + i * 0.5, 0.15, 8, 16),
                    new THREE.MeshPhongMaterial({ 
                        color: 0x34d399, 
                        emissive: 0x34d399, 
                        emissiveIntensity: 0.4,
                        transparent: true,
                        opacity: 0.7
                    })
                );
                ring.rotation.x = Math.PI / 2 + i * 0.2;
                ring.rotation.y = i * Math.PI / 3;
                classifierGroup.add(ring);
            }
            
            classifierGroup.userData.pulsePhase = Math.PI / 4;
            classifierGroup.userData.material = classifierCore.material;
            
            classifierGroup.position.set(-20, 8, 20);
            scene.add(classifierGroup);
            
            addLabel('Classifier<br><small>Win/Loss</small>', classifierGroup, 'label-ml');

            // Regressor Model (Right) - Score Prediction
            const regressorGroup = new THREE.Group();
            
            const regressorCore = new THREE.Mesh(
                new THREE.SphereGeometry(2.5, 32, 32),
                new THREE.MeshPhongMaterial({ 
                    color: 0xec4899,
                    emissive: 0xec4899, 
                    emissiveIntensity: 0.7,
                    shininess: 120
                })
            );
            regressorGroup.add(regressorCore);
            
            // Neural rings
            for (let i = 0; i < 3; i++) {
                const ring = new THREE.Mesh(
                    new THREE.TorusGeometry(1.5 + i * 0.5, 0.15, 8, 16),
                    new THREE.MeshPhongMaterial({ 
                        color: 0xf472b6, 
                        emissive: 0xf472b6, 
                        emissiveIntensity: 0.4,
                        transparent: true,
                        opacity: 0.7
                    })
                );
                ring.rotation.x = Math.PI / 2 + i * 0.2;
                ring.rotation.y = -i * Math.PI / 3;
                regressorGroup.add(ring);
            }
            
            regressorGroup.userData.pulsePhase = Math.PI / 2;
            regressorGroup.userData.material = regressorCore.material;
            
            regressorGroup.position.set(-20, 8, -20);
            scene.add(regressorGroup);
            
            addLabel('Regressor<br><small>Score Prediction</small>', regressorGroup, 'label-ml');

            // ========================================
            // LAYER 3: APPLICATION SERVER (Business Logic)
            // ========================================
            
            const appServerGroup = new THREE.Group();
            
            // Main server cube (larger, centered)
            const serverCore = new THREE.Mesh(
                new THREE.BoxGeometry(6, 6, 6),
                new THREE.MeshPhongMaterial({ 
                    color: 0x5a6c7d,
                    emissive: 0x5a6c7d, 
                    emissiveIntensity: 0.5,
                    shininess: 80
                })
            );
            appServerGroup.add(serverCore);
            
            // Processing layers
            for (let i = -2; i <= 2; i += 1) {
                const layer = new THREE.Mesh(
                    new THREE.BoxGeometry(5.8, 0.2, 5.8),
                    new THREE.MeshPhongMaterial({ 
                        color: 0x3d4856, 
                        emissive: 0x3d4856, 
                        emissiveIntensity: 0.3 
                    })
                );
                layer.position.y = i;
                appServerGroup.add(layer);
            }
            
            // Status LEDs
            for (let i = 0; i < 4; i++) {
                const led = new THREE.Mesh(
                    new THREE.SphereGeometry(0.3, 16, 16),
                    new THREE.MeshPhongMaterial({ 
                        color: 0x50c878,
                        emissive: 0x50c878, 
                        emissiveIntensity: 1.0 
                    })
                );
                led.position.set(-2 + i * 1.3, 3.2, 3.2);
                appServerGroup.add(led);
            }
            
            appServerGroup.userData.pulsePhase = Math.PI * 2 / 3;
            appServerGroup.userData.material = serverCore.material;
            
            appServerGroup.position.set(0, 0, 0);
            scene.add(appServerGroup);
            
            addLabel('Application Server<br><small>Flask Backend</small>', appServerGroup, 'label-backend');

            // ========================================
            // LAYER 4: DATA STORAGE (Database + Schema)
            // ========================================
            
            // PostgreSQL Database
            const dbGroup = new THREE.Group();
            
            const dbCylinder = new THREE.Mesh(
                new THREE.CylinderGeometry(3, 3, 5, 32),
                new THREE.MeshPhongMaterial({ 
                    color: 0x2a9d8f,
                    emissive: 0x2a9d8f, 
                    emissiveIntensity: 0.6,
                    shininess: 100
                })
            );
            dbGroup.add(dbCylinder);
            
            // Database disks
            for (let i = -2; i <= 2; i += 1) {
                const disk = new THREE.Mesh(
                    new THREE.CylinderGeometry(3.2, 3.2, 0.2, 32),
                    new THREE.MeshPhongMaterial({ 
                        color: 0x1e7a6e, 
                        emissive: 0x1e7a6e, 
                        emissiveIntensity: 0.3 
                    })
                );
                disk.position.y = i;
                dbGroup.add(disk);
            }
            
            dbGroup.userData.pulsePhase = Math.PI;
            dbGroup.userData.material = dbCylinder.material;
            
            dbGroup.position.set(25, -8, 15);
            scene.add(dbGroup);
            
            addLabel('Data Storage<br><small>PostgreSQL</small>', dbGroup, 'label-db');

            // HCL Schema (stacked data cubes)
            const hclGroup = new THREE.Group();
            
            for (let i = 0; i < 3; i++) {
                const cube = new THREE.Mesh(
                    new THREE.BoxGeometry(4, 1.5, 4),
                    new THREE.MeshPhongMaterial({ 
                        color: 0xf59e0b,
                        emissive: 0xf59e0b, 
                        emissiveIntensity: 0.6,
                        shininess: 90
                    })
                );
                cube.position.y = i * 1.7 - 1.7;
                hclGroup.add(cube);
                
                const cubeEdges = new THREE.EdgesGeometry(cube.geometry);
                const cubeLine = new THREE.LineSegments(cubeEdges, new THREE.LineBasicMaterial({ color: 0xfbbf24, linewidth: 2 }));
                cube.add(cubeLine);
            }
            
            hclGroup.userData.pulsePhase = Math.PI * 4 / 3;
            hclGroup.userData.material = hclGroup.children[0].material;
            
            hclGroup.position.set(25, -8, -15);
            scene.add(hclGroup);
            
            addLabel('Data Schema<br><small>HCL Tables</small>', hclGroup, 'label-schema');

            // ========================================
            // LAYER 5: EXTERNAL DATA (nflverse)
            // ========================================
            
            const nflverseGroup = new THREE.Group();
            
            const dataCloud = new THREE.Mesh(
                new THREE.SphereGeometry(3.5, 32, 32),
                new THREE.MeshPhongMaterial({ 
                    color: 0x8b5cf6,
                    emissive: 0x8b5cf6, 
                    emissiveIntensity: 0.6,
                    shininess: 100,
                    transparent: true,
                    opacity: 0.9
                })
            );
            nflverseGroup.add(dataCloud);
            
            // Data orbs
            const orbPositions = [
                [-2.5, 1.5, 0], [2.5, 1.5, 0], [0, 1.5, 2.5], [0, 1.5, -2.5],
                [-2, -1.5, 2], [2, -1.5, 2], [-2, -1.5, -2], [2, -1.5, -2]
            ];
            
            orbPositions.forEach(pos => {
                const orb = new THREE.Mesh(
                    new THREE.SphereGeometry(0.6, 16, 16),
                    new THREE.MeshPhongMaterial({ 
                        color: 0xa78bfa, 
                        emissive: 0xa78bfa, 
                        emissiveIntensity: 0.5,
                        transparent: true,
                        opacity: 0.8
                    })
                );
                orb.position.set(pos[0], pos[1], pos[2]);
                nflverseGroup.add(orb);
            });
            
            nflverseGroup.userData.pulsePhase = Math.PI * 5 / 3;
            nflverseGroup.userData.material = dataCloud.material;
            
            nflverseGroup.position.set(50, -8, 0);
            scene.add(nflverseGroup);
            
            addLabel('External Data<br><small>nflverse API</small>', nflverseGroup, 'label-external');

            // ========================================
            // DATA FLOW CONNECTIONS
            // ========================================
            
            function createConnection(start, end, color) {
                const points = [start, end];
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const material = new THREE.LineBasicMaterial({ 
                    color: color,
                    opacity: 0.5,
                    transparent: true,
                    linewidth: 3
                });
                const line = new THREE.Line(geometry, material);
                scene.add(line);
            }

            // UI ‚Üí App Server
            createConnection(new THREE.Vector3(-40, 8, 0), new THREE.Vector3(0, 0, 0), 0x4a90e2);
            
            // App Server ‚Üí Classifier
            createConnection(new THREE.Vector3(0, 0, 0), new THREE.Vector3(-20, 8, 20), 0x10b981);
            
            // App Server ‚Üí Regressor
            createConnection(new THREE.Vector3(0, 0, 0), new THREE.Vector3(-20, 8, -20), 0xec4899);
            
            // App Server ‚Üí PostgreSQL
            createConnection(new THREE.Vector3(0, 0, 0), new THREE.Vector3(25, -8, 15), 0x2a9d8f);
            
            // App Server ‚Üí HCL Schema
            createConnection(new THREE.Vector3(0, 0, 0), new THREE.Vector3(25, -8, -15), 0xf59e0b);
            
            // HCL ‚Üí nflverse (data ingestion)
            createConnection(new THREE.Vector3(25, -8, -15), new THREE.Vector3(50, -8, 0), 0x8b5cf6);
            
            // PostgreSQL ‚Üí nflverse (data ingestion)
            createConnection(new THREE.Vector3(25, -8, 15), new THREE.Vector3(50, -8, 0), 0xa78bfa);
            
            console.log('üì± Mobile App Architecture built successfully!');
        }
        
        function animate() {
            animationId = requestAnimationFrame(animate);
            
            controls.update();
            
            // Animate components (pulsing)
            const time = Date.now() * 0.001;
            scene.traverse((object) => {
                if (object.userData && object.userData.pulsePhase !== undefined) {
                    const pulse = Math.sin(time * 2 + object.userData.pulsePhase) * 0.1 + 1;
                    if (object.userData.material && object.userData.material.emissiveIntensity !== undefined) {
                        object.userData.material.emissiveIntensity = 0.3 + Math.sin(time * 2 + object.userData.pulsePhase) * 0.2;
                    }
                }
            });
            
            renderer.render(scene, camera);
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        function resetCamera() {
            camera.position.set(0, 20, 60);
            controls.target.set(0, 0, 0);
            controls.update();
        }
        
        function toggleAutoRotate() {
            autoRotate = !autoRotate;
            controls.autoRotate = autoRotate;
        }
        
        // Initialize on load
        window.addEventListener('load', init);
    </script>
</body>
</html>
